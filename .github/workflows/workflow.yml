on:
    push:
    workflow_dispatch:

defaults:
    run:
        shell: bash

jobs:
    job:
        runs-on: macos-15
        steps:
            - name: Install xcodes
              run: |
                curl --remote-name --location https://github.com/XcodesOrg/xcodes/releases/latest/download/xcodes.zip
                unzip xcodes.zip
                echo "xcodes $(./xcodes version) installed"

            - name: Install fastlane
              run: |
                brew install fastlane
                echo "fastlane $(fastlane --version) installed"

            - name: Install Xcode
              run: |
                mkdir -p "$HOME/.fastlane/spaceship/${{ secrets.APPLE_ACCOUNT_EMAIL }}"
                echo -E "$FASTLANE_COOKIE" > "$HOME/.fastlane/spaceship/${{ secrets.APPLE_ACCOUNT_EMAIL }}/cookie"
                shasum -a 256 "$HOME/.fastlane/spaceship/${{ secrets.APPLE_ACCOUNT_EMAIL }}/cookie"
                # fastlane spaceauth --user ${{ secrets.APPLE_ACCOUNT_EMAIL }}
              env:
                FASTLANE_PASSWORD: ${{ secrets.APPLE_ACCOUNT_PASSWORD }}
                FASTLANE_COOKIE: ${{ secrets.FASTLANE_COOKIE }}
